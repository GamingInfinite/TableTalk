import{S as Z,i as $,s as tt,F as rt,e as v,k as Y,c as f,a as x,d as h,m as L,b as u,g as S,G as N,H as ot,I as et,J as at,q as it,o as nt,K as I,L as lt,t as j,h as C,M as g,E as st,N as ct,j as dt}from"../chunks/index-45f71731.js";import{G as M,p as X,a as q,b as F,r as O,s as P,c as B,g as H,d as V,U,e as J,f as bt,h as pt,i as K,j as wt,k as ht,l as W,m as Q}from"../chunks/stores-57d30480.js";import"../chunks/index-65a915e8.js";const{window:ut}=lt;function gt(b){let o,n,l,s,w,p,e,a,m,c,t,i,z,y,k,_,r;return{c(){o=v("label"),n=j("Sign In"),l=Y(),s=v("input"),w=Y(),p=v("label"),e=v("label"),a=v("label"),m=j("\u2715"),c=Y(),t=v("button"),i=j("Sign-in with Google"),z=Y(),y=v("button"),k=j("Sign-in Anonymously"),this.h()},l(d){o=f(d,"LABEL",{for:!0,class:!0});var E=x(o);n=C(E,"Sign In"),E.forEach(h),l=L(d),s=f(d,"INPUT",{type:!0,id:!0,class:!0}),w=L(d),p=f(d,"LABEL",{for:!0,class:!0});var R=x(p);e=f(R,"LABEL",{class:!0,for:!0});var A=x(e);a=f(A,"LABEL",{for:!0,class:!0});var D=x(a);m=C(D,"\u2715"),D.forEach(h),c=L(A),t=f(A,"BUTTON",{class:!0});var G=x(t);i=C(G,"Sign-in with Google"),G.forEach(h),z=L(A),y=f(A,"BUTTON",{class:!0});var T=x(y);k=C(T,"Sign-in Anonymously"),T.forEach(h),A.forEach(h),R.forEach(h),this.h()},h(){u(o,"for","signInModal"),u(o,"class","btn btn-primary"),u(s,"type","checkbox"),u(s,"id","signInModal"),u(s,"class","modal-toggle"),u(a,"for","signInModal"),u(a,"class","btn btn-sm btn-circle absolute right-2 top-2"),u(t,"class","btn btn-ghost gap-2"),u(y,"class","btn btn-ghost gap-2"),u(e,"class","modal-box relative"),u(e,"for",""),u(p,"for","signInModal"),u(p,"class","modal cursor-pointer")},m(d,E){S(d,o,E),g(o,n),S(d,l,E),S(d,s,E),S(d,w,E),S(d,p,E),g(p,e),g(e,a),g(a,m),g(e,c),g(e,t),g(t,i),g(e,z),g(e,y),g(y,k),_||(r=[N(t,"click",b[6]),N(y,"click",b[5])],_=!0)},p:st,d(d){d&&h(o),d&&h(l),d&&h(s),d&&h(w),d&&h(p),_=!1,ct(r)}}}function mt(b){let o,n,l,s,w,p,e,a,m,c;return{c(){o=v("div"),n=v("label"),l=j(b[0]),s=Y(),w=v("ul"),p=v("li"),e=v("a"),a=j("Sign Out"),this.h()},l(t){o=f(t,"DIV",{class:!0});var i=x(o);n=f(i,"LABEL",{tabindex:!0,class:!0});var z=x(n);l=C(z,b[0]),z.forEach(h),s=L(i),w=f(i,"UL",{tabindex:!0,class:!0});var y=x(w);p=f(y,"LI",{});var k=x(p);e=f(k,"A",{});var _=x(e);a=C(_,"Sign Out"),_.forEach(h),k.forEach(h),y.forEach(h),i.forEach(h),this.h()},h(){u(n,"tabindex","0"),u(n,"class","btn btn-ghost m-1"),u(w,"tabindex","0"),u(w,"class","dropdown-content menu p-2 shadow bg-base-100 rounded-box w-52"),u(o,"class","dropdown dropdown-end")},m(t,i){S(t,o,i),g(o,n),g(n,l),g(o,s),g(o,w),g(w,p),g(p,e),g(e,a),m||(c=N(e,"click",b[7]),m=!0)},p(t,i){i&1&&dt(l,t[0])},d(t){t&&h(o),m=!1,c()}}}function vt(b){let o,n,l,s,w;function p(t,i){return t[0]!=""?mt:gt}let e=p(b),a=e(b);const m=b[9].default,c=rt(m,b,b[8],null);return{c(){o=v("div"),a.c(),n=Y(),c&&c.c(),this.h()},l(t){o=f(t,"DIV",{class:!0});var i=x(o);a.l(i),i.forEach(h),n=L(t),c&&c.l(t),this.h()},h(){u(o,"class","absolute right-0 top-0 mr-8 mt-8")},m(t,i){S(t,o,i),a.m(o,null),S(t,n,i),c&&c.m(t,i),l=!0,s||(w=N(ut,"beforeunload",b[10]),s=!0)},p(t,[i]){e===(e=p(t))&&a?a.p(t,i):(a.d(1),a=e(t),a&&(a.c(),a.m(o,null))),c&&c.p&&(!l||i&256)&&ot(c,m,t,t[8],l?at(m,t[8],i,null):et(t[8]),null)},i(t){l||(it(c,t),l=!0)},o(t){nt(c,t),l=!1},d(t){t&&h(o),a.d(),t&&h(n),c&&c.d(t),s=!1,w()}}}function ft(b,o,n){let l,s,w,p,e,a;I(b,wt,r=>n(1,l=r)),I(b,F,r=>n(2,s=r)),I(b,X,r=>n(3,w=r)),I(b,B,r=>n(4,p=r)),I(b,q,r=>n(11,e=r)),I(b,ht,r=>n(12,a=r));let{$$slots:m={},$$scope:c}=o;const t=new M;l.onAuthStateChanged(r=>{r&&(X.set(r),q.set(r.uid),F.set(O(a,"players/"+e)),r.isAnonymous==!0?(P(s,{name:"Anon"}),B.set(!0)):(H(V(O(a,"players/"),e)).then(d=>{d.child("name").exists()||(P(s,{name:r.displayName}),U.set(r.displayName))}),B.set(!1)),J&&J.set(r.photoURL),H(V(s,"name")).then(d=>{d.val()!=null&&U.set(d.val())}))});const i=()=>{bt(l)},z=()=>{pt(l,t).then(r=>{M.credentialFromResult(r).accessToken,r.user}).catch(r=>{r.code,r.message,r.customData.email,M.credentialFromError(r)})},y=()=>{p&&(W(w),Q(s)),K(l).then(()=>{U.set("")}).catch(r=>{console.log(r)}),window.location.href="/"};var k="";U.subscribe(r=>{n(0,k=r)});const _=()=>{p&&(W(w),Q(s),K(l).then(()=>{U.set("")}).catch(r=>{console.log(r)}))};return b.$$set=r=>{"$$scope"in r&&n(8,c=r.$$scope)},[k,l,s,w,p,i,z,y,c,m,_]}class zt extends Z{constructor(o){super(),$(this,o,ft,vt,tt,{})}}export{zt as default};
